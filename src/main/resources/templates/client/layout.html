<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fashion Shop - Phong cách IvyModa</title>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
<link
	href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" th:href="@{/client/css/style.css}">
</head>
<body style="font-family: 'Montserrat', sans-serif;">

	<header th:replace="~{client/fragments/header :: header}"></header>

	<main style="min-height: 600px; padding-top: 20px;">
		<div layout:fragment="content"></div>
	</main>

	<footer th:replace="~{client/fragments/footer :: footer}"></footer>

	<div id="cartOverlay" class="cart-overlay" onclick="closeMiniCart()"></div>
	<div id="miniCartSidebar" class="mini-cart-sidebar">
		<div class="mini-cart-header">
			<h5>
				Giỏ hàng <span class="badge badge-dark rounded-circle"
					th:text="${globalCartCount}">0</span>
			</h5>
			<button onclick="closeMiniCart()" class="close-btn">&times;</button>
		</div>
		<div class="mini-cart-body">
			<div
				th:if="${globalCart == null || #lists.isEmpty(globalCart.items)}"
				class="text-center py-5">
				<p>Giỏ hàng đang trống</p>
			</div>
			<th:block th:if="${globalCart != null}">
				<div th:each="item : ${globalCart.items}" class="mini-cart-item">
					<div class="d-flex">
						<img
							th:src="@{'/uploads/' + ${item.variant.productColor.images[0].imageUrl}}"
							class="mini-cart-img">
						<div class="ml-3 w-100">
							<p class="mb-1 font-weight-bold"
								th:text="${item.variant.productColor.product.name}">Tên SP</p>
							<small class="text-muted"> Màu: <span
								th:text="${item.variant.productColor.color.name}"></span> |
								Size: <span th:text="${item.variant.size.name}"></span></small>
							<div
								class="d-flex justify-content-between align-items-center mt-2">
								<div class="qty-small">
									<span class="qty-text" th:text="'x ' + ${item.quantity}"></span>
								</div>
								<span class="font-weight-bold text-danger"
									th:with="unitPrice=${item.variant.productColor.product.basePrice}"
									th:text="${#numbers.formatDecimal(unitPrice * item.quantity, 0, 'COMMA', 0, 'POINT')} + 'đ'"></span>
							</div>
						</div>
					</div>
				</div>
			</th:block>
		</div>
		<div class="mini-cart-footer">
			<div class="d-flex justify-content-between mb-3">
				<span class="font-weight-bold">Tổng cộng:</span> <span
					class="font-weight-bold text-danger" style="font-size: 18px;"
					th:text="${#numbers.formatDecimal(globalTotalPrice, 0, 'COMMA', 0, 'POINT')} + 'đ'">0đ</span>
			</div>
			<a th:href="@{/cart}"
				class="btn btn-dark btn-block mb-2 py-3 font-weight-bold"
				style="border-radius: 0;"> XEM GIỎ HÀNG </a>
			<div th:if="${!isLoggedIn}">
				<a th:href="@{/login}"
					class="btn btn-outline-dark btn-block py-3 font-weight-bold"
					style="border-radius: 0;"> ĐĂNG NHẬP </a>
			</div>
			<div th:if="${isLoggedIn}">
				<a th:href="@{/order/checkout}"
					class="btn btn-outline-dark btn-block py-3 font-weight-bold"
					style="border-radius: 0;"> THANH TOÁN </a>
			</div>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

	<script th:src="@{/client/js/script.js}"></script>

	<th:block layout:fragment="pageScripts"></th:block>

</body>
</html>